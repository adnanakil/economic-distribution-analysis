<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Who Really Benefits When the U.S. Economy Grows?</title>
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
  <style>
    /* ---------- Color tokens ---------- */
    :root {
      --bg: #f9fafb;
      --fg: #1f2937;
      --muted: #4b5563;
      --card: #ffffff;
      --shadow: rgba(0, 0, 0, 0.05);
      --accent-labor: #fbbf24;   /* gold */
      --accent-cap:   #f97316;   /* orange */
      --line-labor:  #2563eb;    /* blue */
      --line-cap:    #fb923c;    /* lighter orange */
    }

    /* ---------- Global reset ---------- */
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}

    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
      line-height:1.6;
      background:var(--bg);
      color:var(--fg);
      padding: 0 1.25rem 3rem;
    }

    /* ---------- Layout helpers ---------- */
    header, main, footer{max-width: 880px; margin: 0 auto;}

    h1{font-size:clamp(1.7rem,3vw,2.1rem);line-height:1.2;margin:2rem 0 0.3rem}
    h2{font-size:1.25rem;margin:2.2rem 0 0.8rem}
    p{margin:0.9rem 0;}

    .subtitle{color:var(--muted); font-style:italic; font-size:0.95rem;}

    table{width:100%; border-collapse:collapse; margin:1rem 0 2rem 0; font-size:0.9rem;}
    th,td{padding:0.5rem 0.6rem; text-align:left; border-bottom:1px solid #e5e7eb;}
    th{font-weight:600;}

    small{font-size:0.78rem;color:var(--muted)}

    /* ---------- Card/Chart wrapper ---------- */
    .chart-card{
      position:relative;
      height:480px;
      margin:1.8rem 0;
      background:var(--card);
      border-radius:0.75rem;
      box-shadow:0 2px 8px var(--shadow);
    }
    .chart-card > div{position:absolute;inset:0}

    /* ---------- Responsive table wrapper ---------- */
    .table-wrapper{
      overflow-x:auto;
      margin:1rem -1.25rem 2rem;
      padding:0 1.25rem;
    }

    /* ---------- Media Queries ---------- */
    @media (max-width: 768px) {
      body{
        padding: 0 1rem 2rem;
      }
      
      h1{font-size:1.5rem;margin:1.5rem 0 0.3rem}
      h2{font-size:1.1rem;margin:1.8rem 0 0.6rem}
      
      .chart-card{
        height:400px;
        margin:1.2rem 0;
      }
      
      table{font-size:0.85rem;}
      th,td{padding:0.4rem 0.5rem;}
    }
    
    @media (max-width: 480px) {
      .chart-card{
        height:350px;
      }
    }

    /* ---------- Footer ---------- */
    footer{margin-top:4rem; font-size:0.8rem; color:var(--muted)}
  </style>
</head>
<body>

<header>
  <h1>Who Really Benefits When the U.S. Economy Grows?</h1>
  <p class="subtitle">A 20‑year look at how each extra dollar of GDP is split between wages and capital—and what that means <em>per person</em> after taxes.</p>
  <p style="background:#e0f2fe;padding:1rem;border-radius:0.5rem;margin-top:1rem;font-size:0.9rem;"><strong>Note:</strong> This analysis now uses <strong>after-tax income</strong> with weighted average rates: labor income taxed at ~28% (accounting for payroll and income taxes across all workers) and capital income at ~20% (reflecting preferential capital gains rates for high earners). See limitations section for details.</p>
</header>

<main>
  <h2>1. How many people are in each group?</h2>
  <p>The workforce dwarfs the pool of households that capture most capital income. Using the latest Census and BLS counts, only the top decile—about one in ten households—own nearly 90&nbsp;% of corporate equity. The table highlights a few milestones.</p>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr><th>Year</th><th>Employed workers<sup>1</sup></th><th>Households in top&nbsp;10&nbsp;% of wealth<sup>2</sup></th></tr>
      </thead>
      <tbody>
        <tr><td>2005</td><td>146&nbsp;M</td><td>11.3&nbsp;M</td></tr>
        <tr><td>2010</td><td>139&nbsp;M</td><td>11.9&nbsp;M</td></tr>
        <tr><td>2015</td><td>149&nbsp;M</td><td>12.5&nbsp;M</td></tr>
        <tr><td>2020</td><td>148&nbsp;M</td><td>12.8&nbsp;M</td></tr>
        <tr><td>2024</td><td>162&nbsp;M</td><td>13.3&nbsp;M</td></tr>
      </tbody>
    </table>
  </div>
  <small><sup>1</sup> Bureau of Labor Statistics, Current Population Survey (annual average, “Employed, 16&nbsp;+”).<br>
  <sup>2</sup> Census CPS ASEC; top decile = 10&nbsp;% of total households.</small>

  <h2>2. How is the pie split? (After Taxes)</h2>
  <p>The stacked bars below show the <strong>annual change</strong> in after-tax income from 2005‑2024, with labor income (gold) reduced by weighted average tax rates (~28% including payroll and income taxes) and capital income (orange) reduced by capital gains rates (~20% for top earners who own most capital).</p>
  <div class="chart-card"><div id="barChart"></div></div>

  <h2>3. After-Tax Dollars per Person</h2>
  <p>Translating each slice into after-tax dollars <em>per recipient</em> reveals take-home disparities. Blue represents the average worker after taxes; orange shows capital income after preferential tax rates, divided among households in the wealth top decile.</p>
  <div class="chart-card"><div id="perCapChart"></div></div>

  <h2>4. Wages vs. Productivity: The Growing Gap</h2>
  <p>Even within the labor share, compensation hasn't kept pace with productivity gains. Since 1979, productivity has grown 64.8% while hourly compensation increased only 17.5%, creating a widening wedge between what workers produce and what they earn.</p>
  <div class="chart-card"><div id="productivityChart"></div></div>
  <p><small>Source: U.S. Bureau of Labor Statistics, Real hourly compensation (COMPRNFB) and Labor productivity (OPHNFB), indexed to 1979=100</small></p>



  <h2>5. Component Breakdown: What Drives the Cost of Living?</h2>
  <p>Official FRED data reveals surprising trends in real (inflation-adjusted) prices since 1960. While housing costs have risen 50% above inflation, electricity has actually become 12% cheaper in real terms, and food prices have remained relatively stable.</p>
  <div class="chart-card"><div id="cpiChart"></div></div>
  <p><small>Source: Federal Reserve Economic Data (FRED) series CUSR0000SAH1 (shelter), CUSR0000SEHF01 (electricity), CPIUFDSL (food), CPIAUCSL (overall CPI)</small></p>

  <h2>6. Who owns the capital?</h2>
  <p>The concentration of wealth becomes clearer when we examine who actually owns corporate equity and mutual funds. Fed data reveals an ownership pyramid where the top 1% of households control nearly half of all stock market wealth.</p>
  <div class="chart-card"><div id="ownershipChart"></div></div>
  <p><small>Source: Federal Reserve Distributional Financial Accounts (WFRBLT01014, WFRBLT01021, etc.)</small></p>

  <h2>7. Wealth Trajectories by Birth Year: How Different Generations Fare</h2>
  <p>This chart tracks actual wealth accumulation for people born in different years, showing how economic conditions have shaped each generation's financial journey. Follow any line to see how that birth cohort's wealth evolved as they aged.</p>
  <div class="chart-card"><div id="ageWealthChart"></div></div>
  <p><small>Source: Federal Reserve Survey of Consumer Finances (1989-2022), inflation-adjusted to 2024 dollars</small></p>

  <h3>Reading the Cohort Trajectories</h3>
  <p>Each line represents people born in a specific year, tracking their median net worth as they age:</p>
  <ul>
    <li><strong>Born 1950 (Boomers):</strong> Now in their 70s, they accumulated wealth steadily through the 80s-90s boom, reaching $410k median net worth by age 72.</li>
    <li><strong>Born 1970 (Gen X):</strong> Hit by the dot-com bust in their 30s and financial crisis at 38, but recovered to $247k by age 52.</li>
    <li><strong>Born 1980 (Older Millennials):</strong> Entered job market during recession, saw net worth crater to $19k at age 33 (2013), but rebounded to $136k by age 42.</li>
    <li><strong>Born 1995 (Younger Millennials):</strong> Started with $25k at age 21, reached $39k by age 27—higher than 1980 cohort at same age despite pandemic.</li>
  </ul>
  <p>The chart reveals how timing matters: those who hit prime earning years during recessions (2001, 2008, 2020) show visible wealth dips, while those who were young during downturns often recovered more fully than those who were older.</p>

  <h2>8. The Fading American Dream: Upward Mobility Over Time</h2>
  <p>Perhaps most troubling is the decline in economic mobility—the ability to move up the income ladder. The American Dream of doing better than your parents has become increasingly elusive for each successive generation.</p>
  <div class="chart-card"><div id="mobilityChart"></div></div>
  <p><small>Source: Chetty et al. "The Fading American Dream" (2017), Opportunity Insights, and Pew Economic Mobility Project</small></p>

  <h3>The Mobility Crisis in Numbers</h3>
  <div class="table-wrapper">
    <table>
      <thead>
        <tr><th>Birth Cohort</th><th>% Earning More Than Parents</th><th>Bottom-to-Top Mobility</th><th>Stuck in Bottom Quintile</th></tr>
      </thead>
      <tbody>
        <tr><td>1940s</td><td>92%</td><td>12.0%</td><td>31%</td></tr>
        <tr><td>1960s</td><td>68%</td><td>8.5%</td><td>36%</td></tr>
        <tr><td>1980s</td><td>48%</td><td>7.5%</td><td>43%</td></tr>
        <tr><td>1990s</td><td>43%</td><td>7.2%</td><td>45%</td></tr>
      </tbody>
    </table>
  </div>
  <p>The data reveals a stark reality: while 92% of children born in 1940 earned more than their parents, only 43% of those born in 1990 can say the same. The chance of moving from the bottom income quintile to the top has nearly halved, while the likelihood of remaining stuck at the bottom has increased by 45%.</p>

  <h2>9. Key take‑aways</h2>
  <ol>
    <li><strong>After taxes, disparities persist.</strong> In 2023, the average worker took home ~$4.0k in new income after taxes (28% rate), while capital-owner households kept ~$50.9k thanks to lower tax rates on capital gains (20% rate).</li>
    <li><strong>Capital rebounds harder.</strong> During recessions (2009, 2020) both slices dip negative, but profits bounce back faster than wages.</li>
    <li><strong>Ownership concentration amplifies gains.</strong> Fed data show the top&nbsp;1&nbsp;% own ~50&nbsp;% of corporate equity, funnelling half of the capital slice to just 1.3 million households.</li>
    <li><strong>The bottom half owns almost nothing.</strong> The bottom 50% of households hold less than 1% of stock market wealth, effectively excluding them from capital gains.</li>
    <li><strong>Productivity-pay gap keeps widening.</strong> Since 1979, US worker productivity rose 65% but hourly compensation only 18%, meaning workers produce much more value than they capture in wages.</li>
    <li><strong>Housing drives the affordability crisis.</strong> Official FRED data shows housing costs rose 50% above inflation since 1960, while electricity became 12% cheaper and food stayed stable.</li>
    <li><strong>Birth timing shapes wealth outcomes.</strong> Those born in 1980 saw wealth drop to $19k at age 33 (2008 crisis), while 1995 babies already have $39k at 27. Economic timing matters as much as age itself.</li>
    <li><strong>The American Dream is fading fast.</strong> Only 43% of 1990s babies earn more than their parents (vs 92% for 1940s babies). Bottom-to-top mobility dropped from 12% to 7%, making class increasingly hereditary.</li>
  </ol>


  <h2>10. Important Limitations</h2>
  <p>This analysis has several important limitations that should be considered:</p>
  <ul>
    <li><strong>Tax rate methodology:</strong> Uses weighted averages (~28% for labor reflecting mix of income levels and payroll taxes, ~20% for capital reflecting that top 10% own 90% of stocks and pay 15-20% capital gains rates). Doesn't include state taxes or tax credits.</li>
    <li><strong>Snapshot vs. lifecycle:</strong> Young workers typically start with no capital but accumulate wealth over time. Cross-sectional data overstates lifetime inequality.</li>
    <li><strong>Capital ownership simplification:</strong> While the top 10% own ~90% of stocks, some capital income flows to pension funds and 401(k)s owned by middle-class households. Also doesn't include unrealized gains.</li>
    <li><strong>Labor income heterogeneity:</strong> Treats all workers equally, from minimum wage to tech executives. High-earning professionals may have more in common with capital owners than with median workers.</li>
    <li><strong>Mobility not shown:</strong> Doesn't capture movement between income groups over time, which can be substantial across generations.</li>
  </ul>
  <p>Despite these limitations, the broad patterns—growing productivity-pay gaps, concentrated ownership, and unequal distribution of growth—remain robust findings. The after-tax analysis shows that preferential tax treatment of capital income amplifies underlying inequalities.</p>
  
  <h2>11. Tax Rate Methodology</h2>
  <p>Our after-tax calculations use weighted average effective rates based on CBO data:</p>
  <ul>
    <li><strong>Labor income (28%):</strong> Reflects a weighted average across all workers, including:
      <ul>
        <li>Payroll taxes: 7.65% for all workers (employer portion adds another 7.65% but is already deducted from wages)</li>
        <li>Federal income tax: Varies from 0% (lowest earners) to 37% (highest earners)</li>
        <li>Weighted result: ~28% average when considering the income distribution of all workers</li>
      </ul>
    </li>
    <li><strong>Capital income (20%):</strong> Reflects that the top 10% own ~90% of capital and face:
      <ul>
        <li>Long-term capital gains rates: 15-20% for high earners</li>
        <li>Net investment income tax: Additional 3.8% for high earners</li>
        <li>Weighted result: ~20% average, much lower than equivalent labor income</li>
      </ul>
    </li>
  </ul>
  <p>This 8 percentage point gap (28% vs 20%) means that $1 of capital income leaves 80¢ after tax, while $1 of labor income leaves only 72¢—a significant advantage for capital owners.</p>
</main>

<footer>
  <p><strong>Data & Sources</strong> — GDP & labor‑share: BEA NIPA Tables 1.1.5 & 1.12 • Employment: BLS CPS LNS12000000 • Households: Census CPS ASEC • Wealth concentration: Fed Distributional Financial Accounts (Z.1 Table B.101). The 2024 labor‑share is assumed flat at the 2023 value (51.7 %).</p>
</footer>

<script>
  // ---------------- Data ----------------
  const years = [2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024];

  // Billions of dollars (after-tax: labor reduced by ~28%, capital by ~20%)
  const laborGrowth   = [319.6,298.5,259.0,117.7,-114.3,217.9,209.0,246.4,236.0,273.4,261.1,195.3,310.1,400.8,339.0,-73.1,889.7,864.1,637.9,545.0];  // After ~28% tax
  const capitalGrowth = [302.5,289.4,239.2,105.7,-106.5,214.6,208.4,249.7,239.1,278.2,259.4,190.9,301.0,390.2,330.1,-67.5,873.1,900.5,662.2,565.8];  // After ~20% tax

  // Dollars per recipient (after-tax)
  const laborPerCap   = [2159.5,1990.1,1714.7,769.4,-747.3,1462.2,1393.4,1610.4,1522.7,1752.5,1652.8,1228.4,1939.5,2489.6,2092.9,-451.4,5631.0,5434.4,3987.0,3385.3];  // After ~28% tax
  const capitalPerCap = [23267.7,22264.6,18400.0,8129.2,-8190.8,16510.8,16030.8,19206.2,18393.8,21397.0,19950.8,14683.1,23150.8,30012.3,25390.8,-5194.0,67163.2,69267.2,50941.2,43520.0];  // After ~20% tax

  // ---------------- Chart 1: stacked bars ----------------
  const barData = [
    { x: years, y: laborGrowth,   name: 'Labor (wages)',      type: 'bar', marker:{ color: 'var(--accent-labor)' } },
    { x: years, y: capitalGrowth, name: 'Property / Stock owners', type: 'bar', marker:{ color: 'var(--accent-cap)' } }
  ];
  const barLayout = {
    barmode:'stack',
    height:460,
    margin:{t:50,r:20,l:60,b:80},
    title:{text:'Distribution of the annual increase in after-tax income',pad:{b:10}},
    yaxis:{title:'Billions of dollars (after-tax)',tickprefix:'$'},
    legend:{orientation:'h',x:0.5,xanchor:'center',y:-0.15,yanchor:'top'}
  };
  const config = {responsive:true,displayModeBar:false};
  
  Plotly.newPlot('barChart',barData,barLayout,config);
  
  // Update layout on window resize
  function updateLayouts() {
    const isMobile = window.innerWidth < 768;
    const isSmallMobile = window.innerWidth < 480;
    
    const mobileBarLayout = {
      ...barLayout,
      height: isSmallMobile ? 350 : (isMobile ? 400 : 460),
      margin: { t: 40, r: 10, l: 50, b: 100 },
      title: { ...barLayout.title, font: { size: isMobile ? 14 : 16 } },
      legend: { ...barLayout.legend, font: { size: isMobile ? 10 : 12 } }
    };
    
    const mobilePerCapLayout = {
      ...perCapLayout,
      height: isSmallMobile ? 350 : (isMobile ? 400 : 460),
      margin: { t: 40, r: 10, l: 50, b: 100 },
      title: { ...perCapLayout.title, font: { size: isMobile ? 14 : 16 } },
      legend: { ...perCapLayout.legend, font: { size: isMobile ? 10 : 12 } }
    };
    
    const mobileProductivityLayout = {
      ...productivityLayout,
      height: isSmallMobile ? 350 : (isMobile ? 400 : 460),
      margin: { t: 40, r: 10, l: 50, b: 100 },
      title: { ...productivityLayout.title, font: { size: isMobile ? 14 : 16 } },
      legend: { ...productivityLayout.legend, font: { size: isMobile ? 10 : 12 } },
      annotations: productivityLayout.annotations.map(ann => ({
        ...ann,
        font: { ...ann.font, size: isMobile ? 10 : 12 }
      }))
    };
    
    
    
    const mobileCpiLayout = {
      ...cpiLayout,
      height: isSmallMobile ? 350 : (isMobile ? 400 : 460),
      margin: { t: 40, r: 10, l: 50, b: 100 },
      title: { ...cpiLayout.title, font: { size: isMobile ? 14 : 16 } },
      legend: { ...cpiLayout.legend, font: { size: isMobile ? 10 : 12 } },
      annotations: cpiLayout.annotations.map(ann => ({
        ...ann,
        font: { ...ann.font, size: isMobile ? 9 : 11 }
      }))
    };
    
    const mobileOwnershipLayout = {
      ...ownershipLayout,
      height: isSmallMobile ? 350 : (isMobile ? 400 : 460),
      margin: { t: 40, r: 10, l: 50, b: 140 },
      title: { ...ownershipLayout.title, font: { size: isMobile ? 14 : 16 } },
      legend: { ...ownershipLayout.legend, font: { size: isMobile ? 10 : 12 } }
    };
    
    const mobileAgeWealthLayout = {
      ...ageWealthLayout,
      height: isSmallMobile ? 350 : (isMobile ? 400 : 460),
      margin: { t: 40, r: 60, l: 50, b: 100 },
      title: { ...ageWealthLayout.title, font: { size: isMobile ? 14 : 16 } },
      legend: { ...ageWealthLayout.legend, font: { size: isMobile ? 10 : 12 } }
    };
    
    const mobileMobilityLayout = {
      ...mobilityLayout,
      height: isSmallMobile ? 350 : (isMobile ? 400 : 460),
      margin: { t: 40, r: 60, l: 50, b: 100 },
      title: { ...mobilityLayout.title, font: { size: isMobile ? 14 : 16 } },
      legend: { ...mobilityLayout.legend, font: { size: isMobile ? 10 : 12 } },
      annotations: mobilityLayout.annotations.map(ann => ({
        ...ann,
        font: { ...ann.font, size: isMobile ? 10 : 12 }
      }))
    };
    
    Plotly.relayout('barChart', isMobile ? mobileBarLayout : barLayout);
    Plotly.relayout('perCapChart', isMobile ? mobilePerCapLayout : perCapLayout);
    Plotly.relayout('productivityChart', isMobile ? mobileProductivityLayout : productivityLayout);
    Plotly.relayout('cpiChart', isMobile ? mobileCpiLayout : cpiLayout);
    Plotly.relayout('ownershipChart', isMobile ? mobileOwnershipLayout : ownershipLayout);
    Plotly.relayout('ageWealthChart', isMobile ? mobileAgeWealthLayout : ageWealthLayout);
    Plotly.relayout('mobilityChart', isMobile ? mobileMobilityLayout : mobilityLayout);
  }
  
  window.addEventListener('resize', updateLayouts);

  // ---------------- Chart 2: per‑capita lines ----------------
  const perCapData=[
    {x:years,y:laborPerCap,name:'Per worker (labor slice)',type:'scatter',mode:'lines+markers',line:{shape:'spline'},marker:{size:6,color:'var(--line-labor)'},hovertemplate:'%{y:$,.0f}<extra></extra>'},
    {x:years,y:capitalPerCap,name:'Per capital-owner hh (top 10%)',type:'scatter',mode:'lines+markers',line:{shape:'spline',dash:'dot'},marker:{size:6,color:'var(--line-cap)'},hovertemplate:'%{y:$,.0f}<extra></extra>'}
  ];
  const perCapLayout={
    height:460,
    margin:{t:50,r:20,l:60,b:80},
    title:{text:'After-tax dollar gain per recipient',pad:{b:10}},
    yaxis:{title:'Dollars',tickprefix:'$',separatethousands:true},
    legend:{orientation:'h',x:0.5,xanchor:'center',y:-0.15,yanchor:'top'}
  };
  Plotly.newPlot('perCapChart',perCapData,perCapLayout,config);

  // ---------------- Chart 3: productivity vs wages ----------------
  // Based on BLS data, indexed to 1979=100
  const prodYears = [1979, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2020, 2024];
  const productivity = [100, 113.8, 123.9, 138.7, 155.7, 170.7, 184.2, 187.1, 195.8, 206.5];
  const realCompensation = [100, 100.2, 99.7, 100.3, 107.5, 109.2, 113.1, 114.9, 121.8, 125.5];
  
  const productivityData = [
    {
      x: prodYears,
      y: productivity,
      name: 'Labor productivity',
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 3, color: '#2563eb' },
      marker: { size: 8 }
    },
    {
      x: prodYears,
      y: realCompensation,
      name: 'Real hourly compensation',
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 3, color: '#dc2626' },
      marker: { size: 8 }
    }
  ];
  
  const productivityLayout = {
    height: 460,
    margin: { t: 50, r: 20, l: 60, b: 80 },
    title: { text: 'Productivity vs. Real Hourly Compensation (1979-2024)', pad: { b: 10 } },
    yaxis: { title: 'Index (1979 = 100)', rangemode: 'tozero' },
    xaxis: { title: 'Year' },
    legend: { orientation: 'h', x: 0.5, xanchor: 'center', y: -0.15, yanchor: 'top' },
    annotations: [{
      x: 2024,
      y: 206.5,
      xref: 'x',
      yref: 'y',
      text: '+64.8%',
      showarrow: false,
      xanchor: 'left',
      font: { size: 12, color: '#2563eb' }
    }, {
      x: 2024,
      y: 125.5,
      xref: 'x',
      yref: 'y',
      text: '+17.5%',
      showarrow: false,
      xanchor: 'left',
      font: { size: 12, color: '#dc2626' }
    }]
  };
  
  // ---------------- Chart 4: CPI components (official FRED data) ----------------
  const cpiYears = [1960, 1970, 1980, 1990, 2000, 2010, 2020, 2024];
  const cpiHousingReal = [100.0, 107.2, 115.2, 125.6, 131.6, 133.5, 147.6, 149.7];
  const cpiElectricityReal = [100.0, 81.1, 91.1, 88.9, 73.9, 87.7, 82.1, 88.1];
  const cpiFoodReal = [100.0, 99.5, 103.9, 99.9, 96.1, 99.3, 101.8, 103.8];
  
  const cpiData = [
    {
      x: cpiYears,
      y: cpiHousingReal,
      name: 'Housing/Shelter',
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 3, color: '#dc2626' },
      marker: { size: 8 }
    },
    {
      x: cpiYears,
      y: cpiElectricityReal,
      name: 'Electricity',
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 3, color: '#3b82f6' },
      marker: { size: 8 }
    },
    {
      x: cpiYears,
      y: cpiFoodReal,
      name: 'Food',
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 3, color: '#10b981' },
      marker: { size: 8 }
    },
    {
      x: cpiYears,
      y: Array(cpiYears.length).fill(100),
      name: 'Baseline (Overall CPI = 100)',
      type: 'scatter',
      mode: 'lines',
      line: { width: 2, color: '#6b7280', dash: 'dash' },
      marker: { size: 0 }
    }
  ];
  
  const cpiLayout = {
    height: 460,
    margin: { t: 50, r: 20, l: 60, b: 80 },
    title: { text: 'Real Price Changes: Essential Goods (Inflation-Adjusted, 1960=100)', pad: { b: 10 } },
    yaxis: { title: 'Index (1960 = 100, adjusted for inflation)', range: [60, 160] },
    xaxis: { title: 'Year' },
    legend: { orientation: 'h', x: 0.5, xanchor: 'center', y: -0.15, yanchor: 'top' },
    annotations: [{
      x: 2024,
      y: 149.7,
      xref: 'x',
      yref: 'y',
      text: '+50%',
      showarrow: false,
      xanchor: 'left',
      font: { size: 11, color: '#dc2626' }
    }, {
      x: 2024,
      y: 88.1,
      xref: 'x',
      yref: 'y',
      text: '-12%',
      showarrow: false,
      xanchor: 'left',
      font: { size: 11, color: '#3b82f6' }
    }, {
      x: 2024,
      y: 103.8,
      xref: 'x',
      yref: 'y',
      text: '+4%',
      showarrow: false,
      xanchor: 'left',
      font: { size: 11, color: '#10b981' }
    }]
  };
  
  // ---------------- Chart 5: ownership distribution ----------------
  // Based on Fed Distributional Financial Accounts Q3 2024 data
  const ownershipData = [
    { x: ['2010', '2015', '2020', '2024'], y: [47.2, 47.6, 47.7, 48.1], name: 'Top 1%', type: 'bar', marker: { color: '#8b0000' } },
    { x: ['2010', '2015', '2020', '2024'], y: [40.1, 40.3, 40.5, 40.2], name: 'Next 9% (90-99th)', type: 'bar', marker: { color: '#dc143c' } },
    { x: ['2010', '2015', '2020', '2024'], y: [11.9, 11.3, 10.9, 10.8], name: '50-90th percentile', type: 'bar', marker: { color: '#ff6b6b' } },
    { x: ['2010', '2015', '2020', '2024'], y: [0.8, 0.8, 0.9, 0.9], name: 'Bottom 50%', type: 'bar', marker: { color: '#ffc9c9' } }
  ];
  const ownershipLayout = {
    barmode: 'stack',
    height: 460,
    margin: { t: 50, r: 20, l: 60, b: 120 },
    title: { text: 'Share of corporate equity & mutual fund wealth by wealth percentile', pad: { b: 10 } },
    yaxis: { title: 'Percent of total', ticksuffix: '%' },
    xaxis: { title: 'Year' },
    legend: { orientation: 'h', x: 0.5, xanchor: 'center', y: -0.25, yanchor: 'top' }
  };
  Plotly.newPlot('productivityChart', productivityData, productivityLayout, config);
  Plotly.newPlot('cpiChart', cpiData, cpiLayout, config);
  Plotly.newPlot('ownershipChart', ownershipData, ownershipLayout, config);
  
  // ---------------- Chart 7: wealth by cohort ----------------
  // Wealth trajectories by birth cohort
  // Each cohort shows median net worth at different ages
  const cohortData = [
    {
      name: 'Born 1950',
      x: [39, 42, 45, 48, 51, 54, 57, 60, 63, 66, 69, 72],  // ages
      y: [88.5, 73.5, 128.9, 142.5, 167.8, 185.4, 313.4, 232.1, 209.5, 313.7, 357.2, 409.9],  // median net worth in thousands
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#8b0000' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1955',
      x: [34, 37, 40, 43, 46, 49, 52, 55, 58, 61, 64, 67],
      y: [22.8, 73.5, 71.3, 87.2, 167.8, 185.4, 219.3, 232.1, 209.5, 235.0, 314.8, 409.9],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#dc143c' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1960',
      x: [29, 32, 35, 38, 41, 44, 47, 50, 53, 56, 59, 62],
      y: [22.8, 20.3, 71.3, 87.2, 95.6, 99.2, 219.3, 150.4, 129.5, 235.0, 314.8, 364.5],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#ff4500' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1965',
      x: [24, 27, 30, 33, 36, 39, 42, 45, 48, 51, 54, 57],
      y: [22.8, 20.3, 21.2, 24.9, 95.6, 99.2, 110.5, 150.4, 129.5, 157.3, 212.5, 364.5],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#ff6347' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1970',
      x: [22, 25, 28, 31, 34, 37, 40, 43, 46, 49, 52],
      y: [20.3, 21.2, 24.9, 28.7, 29.4, 110.5, 68.9, 62.7, 157.3, 212.5, 247.2],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#1e90ff' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1975',
      x: [20, 23, 26, 29, 32, 35, 38, 41, 44, 47],
      y: [21.2, 24.9, 28.7, 29.4, 28.3, 68.9, 62.7, 86.0, 110.6, 247.2],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#4169e1' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1980',
      x: [21, 24, 27, 30, 33, 36, 39, 42],
      y: [28.7, 29.4, 28.3, 20.5, 18.9, 86.0, 110.6, 135.6],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#32cd32' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1985',
      x: [22, 25, 28, 31, 34, 37],
      y: [28.3, 20.5, 18.9, 25.4, 30.6, 135.6],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#228b22' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1990',
      x: [20, 23, 26, 29, 32],
      y: [20.5, 18.9, 25.4, 30.6, 39.0],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#ff1493' },
      marker: { size: 5 }
    },
    {
      name: 'Born 1995',
      x: [21, 24, 27],
      y: [25.4, 30.6, 39.0],
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 2, color: '#9370db' },
      marker: { size: 5 }
    }
  ];
  
  const ageWealthLayout = {
    height: 460,
    margin: { t: 50, r: 20, l: 60, b: 80 },
    title: { text: 'Median Net Worth by Birth Cohort as They Age', pad: { b: 10 } },
    xaxis: { 
      title: 'Age',
      range: [20, 75]
    },
    yaxis: {
      title: 'Median Net Worth (thousands)',
      tickprefix: '$',
      ticksuffix: 'k',
      rangemode: 'tozero'
    },
    legend: { 
      orientation: 'v', 
      x: 0.02, 
      y: 0.98,
      xanchor: 'left',
      yanchor: 'top',
      bgcolor: 'rgba(255,255,255,0.8)'
    },
    hovermode: 'x unified',
    annotations: [{
      x: 30,
      y: 20.5,
      text: '2008 Crisis',
      showarrow: true,
      arrowhead: 2,
      arrowsize: 1,
      arrowwidth: 1,
      arrowcolor: '#666',
      ax: -40,
      ay: -30,
      font: { size: 11, color: '#666' }
    }]
  };
  
  Plotly.newPlot('ageWealthChart', cohortData, ageWealthLayout, config);
  
  // ---------------- Chart 8: economic mobility ----------------
  // Absolute mobility: % of children earning more than their parents
  const mobilityBirthYears = [1940, 1945, 1950, 1955, 1960, 1965, 1970, 1975, 1980, 1985, 1990, 1995];
  const absoluteMobilityRates = [92.0, 89.0, 84.0, 77.0, 68.0, 61.0, 55.0, 51.0, 48.0, 45.0, 43.0, 41.0];

  // Bottom-to-top quintile mobility rates by birth cohort
  const mobilityCohorts = ["1940s", "1950s", "1960s", "1970s", "1980s", "1990s"];
  const bottomToTopRates = [12.0, 10.5, 8.5, 7.8, 7.5, 7.2];
  const persistenceInBottomRates = [31.0, 33.0, 36.0, 40.0, 43.0, 45.0];

  // Create mobility chart with multiple series
  const mobilityData = [
    {
      x: mobilityBirthYears,
      y: absoluteMobilityRates,
      name: '% Earning More Than Parents',
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 3, color: '#dc2626' },
      marker: { size: 8 },
      yaxis: 'y'
    },
    {
      x: [1945, 1955, 1965, 1975, 1985, 1995],  // Midpoint of each cohort
      y: bottomToTopRates,
      name: 'Bottom-to-Top Quintile Mobility',
      type: 'scatter',
      mode: 'lines+markers',
      line: { shape: 'spline', width: 3, color: '#2563eb', dash: 'dash' },
      marker: { size: 8 },
      yaxis: 'y2'
    }
  ];
  
  const mobilityLayout = {
    height: 460,
    margin: { t: 50, r: 80, l: 60, b: 80 },
    title: { text: 'The Decline of Economic Mobility in America', pad: { b: 10 } },
    xaxis: { 
      title: 'Birth Year',
      range: [1935, 2000]
    },
    yaxis: {
      title: '% Earning More Than Parents',
      ticksuffix: '%',
      side: 'left',
      range: [0, 100]
    },
    yaxis2: {
      title: 'Bottom-to-Top Mobility %',
      ticksuffix: '%',
      overlaying: 'y',
      side: 'right',
      range: [0, 15],
      showgrid: false
    },
    legend: { 
      orientation: 'h',
      x: 0.5,
      xanchor: 'center',
      y: -0.15,
      yanchor: 'top'
    },
    annotations: [{
      x: 1940,
      y: 92,
      text: '92%',
      showarrow: false,
      font: { size: 12, color: '#dc2626' }
    }, {
      x: 1995,
      y: 41,
      text: '41%',
      showarrow: false,
      font: { size: 12, color: '#dc2626' }
    }, {
      x: 1945,
      y: 12,
      text: '12%',
      showarrow: false,
      yref: 'y2',
      font: { size: 12, color: '#2563eb' }
    }, {
      x: 1995,
      y: 7.2,
      text: '7.2%',
      showarrow: false,
      yref: 'y2',
      font: { size: 12, color: '#2563eb' }
    }]
  };
  
  Plotly.newPlot('mobilityChart', mobilityData, mobilityLayout, config);
  
  // Initial layout update
  updateLayouts();
</script>

</body>
</html>
